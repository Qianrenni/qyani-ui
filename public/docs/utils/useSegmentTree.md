# UseSegmentTree 类

线段树数据结构实现，支持区间更新和区间查询，可自定义合并函数、懒标记更新函数及默认值。

## 构造函数参数

| 参数         | 类型                                                                 | 必填 | 说明                                                                 |
|--------------|----------------------------------------------------------------------|------|----------------------------------------------------------------------|
| `data`       | `T[]`                                                                | 是   | 原始数据数组                                                         |
| `rootFunc`   | `(left: number, right: number, lazyValue: Lazy, oldValue: T) => T`   | 是   | 懒标记应用函数，决定如何将懒标记作用到节点值                         |
| `mergeFunc`  | `(a: T, b: T) => T`                                                  | 否   | 合并函数，用于合并子区间值，如求和、最大值、最小值等，默认为求和函数 |
| `defaultVal` | `T`                                                                  | 否   | 查询无效区间时的返回值（单位元），默认为 0                           |

## 方法

### `update(left: number, right: number, value: Lazy): void`

更新区间 `[left, right]` 的值，使用传入的 `value` 应用到该区间。

#### 参数

| 参数    | 类型     | 必填 | 说明             |
|---------|----------|------|------------------|
| `left`  | `number` | 是   | 区间左端点（0-based） |
| `right` | `number` | 是   | 区间右端点（0-based） |
| `value` | `Lazy`   | 是   | 要设置/增加的值     |

---

### `query(left: number, right: number): T`

查询区间 `[left, right]` 的合并结果。

#### 参数

| 参数    | 类型     | 必填 | 说明             |
|---------|----------|------|------------------|
| `left`  | `number` | 是   | 查询区间左端点（0-based） |
| `right` | `number` | 是   | 查询区间右端点（0-based） |

#### 返回值

| 类型 | 说明                     |
|------|--------------------------|
| `T`  | 合并后的区间值（如和、最大值等） |

---

### `private _push(root: number, left: number, right: number): void`

将当前节点的懒标记下推给子节点，并更新子节点的值。

#### 参数

| 参数    | 类型     | 必填 | 说明                 |
|---------|----------|------|----------------------|
| `root`  | `number` | 是   | 当前节点编号（1-based） |
| `left`  | `number` | 是   | 当前节点管理的左边界     |
| `right` | `number` | 是   | 当前节点管理的右边界     |

---

### `private _update(...): void`

递归更新线段树中 `[left, right]` 区间，应用懒标记和更新操作。

#### 参数（内部使用）

| 参数    | 类型     | 必填 | 说明                     |
|---------|----------|------|--------------------------|
| `root`  | `number` | 是   | 当前节点编号（1-based）     |
| `start` | `number` | 是   | 当前节点管理的区间左端点     |
| `end`   | `number` | 是   | 当前节点管理的区间右端点     |
| `left`  | `number` | 是   | 待更新区间的左端点（用户输入） |
| `right` | `number` | 是   | 待更新区间的右端点（用户输入） |
| `value` | `Lazy`   | 是   | 要设置/增加的值               |

---

### `private _query(...): T`

递归查询线段树中 `[queryLeft, queryRight]` 区间的合并值。

#### 参数（内部使用）

| 参数        | 类型     | 必填 | 说明                         |
|-------------|----------|------|------------------------------|
| `node`      | `number` | 是   | 当前节点编号（1-based）         |
| `left`      | `number` | 是   | 当前节点管理的左边界             |
| `right`     | `number` | 是   | 当前节点管理的右边界             |
| `queryLeft` | `number` | 是   | 查询区间的左端点                 |
| `queryRight`| `number` | 是   | 查询区间的右端点                 |

#### 返回值

| 类型 | 说明                     |
|------|--------------------------|
| `T`  | 合并后的区间值（如和、最大值等） |

---

## 类型参数

| 类型参数 | 说明                     |
|----------|--------------------------|
| `T`      | 线段树节点值的类型，默认为 `number` |
| `Lazy`   | 懒标记的类型，默认为 `number`     |

---

## Expose 方法

| 方法名   | 参数 | 返回值 | 说明         |
|----------|------|--------|--------------|
| `update` | `(left: number, right: number, value: Lazy): void` | — | 更新指定区间值 |
| `query`  | `(left: number, right: number): T`                | `T` | 查询区间合并值 |

---